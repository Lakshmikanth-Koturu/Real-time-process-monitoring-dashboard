from flask import Flask, jsonify
import psutil

app = Flask(__name__)

@app.route("/stats")
def system_stats():
    cpu = psutil.cpu_percent(interval=1)
    memory = psutil.virtual_memory().percent
    processes = []

    for p in psutil.process_iter(['pid', 'name', 'status', 'cpu_percent', 'memory_percent']):
        processes.append(p.info)

    return jsonify({
        "cpu_usage": cpu,
        "memory_usage": memory,
        "processes": processes
    })

@app.route("/kill/<int:pid>")
def kill_process(pid):
    psutil.Process(pid).kill()
    return jsonify({"status": "terminated"})

if __name__ == "__main__":
    app.run(debug=True)
